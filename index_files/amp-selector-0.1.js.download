(self.AMP=self.AMP||[]).push({n:"amp-selector",v:"1522946816373",f:(function(AMP){function g(a,b){function c(){}c.prototype=b.prototype;a.prototype=new c;a.prototype.constructor=a;for(var d in b)if(Object.defineProperties){var e=Object.getOwnPropertyDescriptor(b,d);e&&Object.defineProperty(a,d,e)}else a[d]=b[d]};self.log=self.log||{user:null,dev:null,userForEmbed:null};var h=self.log;function l(){if(!h.user)throw Error("failed to call initLogConstructor");return h.user};function n(a){if(a.nodeType){var b=(a.ownerDocument||a).defaultView;if(b=b!=(b.__AMP_TOP||b)&&p(b,"action")?q(b,"action"):null)return b}b=r(a);b=r(b);b=b.isSingleDoc()?b.win:b;return q(b,"action")}function r(a){if(a.nodeType){var b=(a.ownerDocument||a).defaultView,b=b.__AMP_TOP||b;a=q(b,"ampdoc").getAmpDoc(a)}return a}
function q(a,b){p(a,b);var c=a.services;c||(c=a.services={});var d=c;a=d[b];a.obj||(a.obj=new a.ctor(a.context),a.ctor=null,a.context=null,a.resolve&&a.resolve(a.obj));return a.obj}function p(a,b){a=a.services&&a.services[b];return!(!a||!a.ctor&&!a.obj)};/*
 https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
function t(a,b){for(var c,d=a;d&&d!==c;d=d.parentElement)if(b(d))return d;return null}function u(a){return a.closest?a.closest("[option]"):t(a,function(a){var b=a.matches||a.webkitMatchesSelector||a.mozMatchesSelector||a.msMatchesSelector||a.oMatchesSelector;return b?b.call(a,"[option]"):!1})}function v(a){var b=a.body.getAttribute("dir")||a.documentElement.getAttribute("dir")||"ltr";return"rtl"==b};var w={NONE:"none",FOCUS:"focus",SELECT:"select"};function x(a){a=AMP.BaseElement.call(this,a)||this;a.l=!1;a.h=[];a.c=[];a.A=[];a.m=!1;a.B=null;a.j=0;a.o="none";return a}g(x,AMP.BaseElement);x.prototype.isLayoutSupported=function(){return!0};
x.prototype.buildCallback=function(){var a=this;this.B=n(this.element);this.l=this.element.hasAttribute("multiple");this.m=this.element.hasAttribute("disabled");this.element.setAttribute("role","listbox");this.l&&this.element.setAttribute("aria-multiselectable","true");this.m&&this.element.setAttribute("aria-disabled","true");var b=this.element.getAttribute("keyboard-select-mode");b?(b=b.toLowerCase(),l().assertEnumValue(w,b),l().assert(!(this.l&&"select"==b),"[keyboard-select-mode=select] not supported for multiple selection amp-selector")):
b="none";this.o=b;this.registerAction("clear",this.w.bind(this));y(this);this.m||(this.element.addEventListener("click",this.C.bind(this)),this.element.addEventListener("keydown",this.D.bind(this)));this.registerAction("selectUp",function(b){var c=b.args;z(a,c&&void 0!==c.delta?-c.delta:-1)},1);this.registerAction("selectDown",function(b){b=b.args;z(a,b&&void 0!==b.delta?b.delta:1)},1);this.registerAction("toggle",function(b){var c=b.args;l().assert(0<=c.index,"'index' must be greater than 0");l().assert(c.index<
a.c.length,"'index' must be less than the length of options in the <amp-selector>");if(c&&void 0!==c.index){b=c.index;var e=c.value,c=a.c[b].hasAttribute("selected"),e=void 0!==e?e:!c,f=a.c.indexOf(a.h[0]);e!==c&&(f!==b?(A(a,a.c[b]),B(a,a.c[f])):B(a,a.c[b]))}},1)};x.prototype.mutatedAttributesCallback=function(a){var b=a.selected;void 0!==b&&C(this,b)};
function C(a,b){if(null===b)a.w();else{var c=Array.isArray(b)?b:[b];a.l||(c=c.slice(0,1));var d=c.reduce(function(a,b){a[b]=!0;return a},Object.create(null));for(b=0;b<a.c.length;b++){var e=a.c[b],f=e.getAttribute("option");d[f]?A(a,e):B(a,e)}D(a);E(a)}}function D(a,b){if("none"!=a.o){a.c.forEach(function(a){a.tabIndex=-1});var c=b;c||(c=a.l?a.c[0]:a.h[0]||a.c[0]);c&&(a.j=a.c.indexOf(c),c.tabIndex=0)}}
function y(a){[].slice.call(a.element.querySelectorAll("[option]")).forEach(function(b){b.setAttribute("role","option");b.hasAttribute("disabled")&&b.setAttribute("aria-disabled","true");b.hasAttribute("selected")?A(a,b):B(a,b);b.tabIndex=0;a.c.push(b)});D(a);E(a)}
function E(a){var b=[],c=a.element.getAttribute("name");if(!c||a.m)return b;var d=a.element.getAttribute("form");a.A.forEach(function(b){a.element.removeChild(b)});a.A=[];var e=a.win.document,f=e.createDocumentFragment();a.h.forEach(function(m){if(!m.hasAttribute("disabled")){var k=e.createElement("input");m=m.getAttribute("option");k.setAttribute("type","hidden");k.setAttribute("name",c);k.setAttribute("value",m);d&&k.setAttribute("form",d);a.A.push(k);f.appendChild(k);b.push(m)}});a.element.appendChild(f);
return b}
function F(a,b){b.hasAttribute("disabled")||a.mutateElement(function(){var c;b.hasAttribute("selected")?a.l&&(B(a,b),c=E(a)):(A(a,b),c=E(a));if(c){D(a,b);var d;d=a.win;c={targetOption:b.getAttribute("option"),selectedOptions:c};var e={detail:c};Object.assign(e,void 0);"function"==typeof d.CustomEvent?d=new d.CustomEvent("amp-selector.select",e):(d=d.document.createEvent("CustomEvent"),d.initCustomEvent("amp-selector.select",!!e.bubbles,!!e.cancelable,c));var f=d;a.B.trigger(a.element,"select",f,100)}})}
x.prototype.C=function(a){if(a=a.target)a.hasAttribute("option")||(a=u(a)),a&&F(this,a)};function z(a,b){var c=a.c.indexOf(a.h[0]);b=c+b;var d=a.c.length,e=0<b&&0<d?b%d:(b%d+d)%d;A(a,a.c[e]);B(a,a.c[c])}
x.prototype.D=function(a){var b=a.keyCode;switch(b){case 37:case 38:case 39:case 40:if("none"!=this.o)a:{var c=this.win.document;switch(a.keyCode){case 37:c=v(c)?1:-1;break;case 38:c=-1;break;case 39:c=v(c)?-1:1;break;case 40:c=1;break;default:break a}a.preventDefault();this.c[this.j].tabIndex=-1;this.j=(this.j+c)%this.c.length;0>this.j&&(this.j+=this.c.length);a=this.c[this.j];a.tabIndex=0;try{a.focus()}catch(d){}a=this.c[this.j];"select"==this.o&&F(this,a)}break;case 13:case 32:c=a.keyCode,32!=
c&&13!=c||!this.c.includes(a.target)||(a.preventDefault(),F(this,a.target))}};function B(a,b){b.removeAttribute("selected");b.setAttribute("aria-selected","false");var c=a.h.indexOf(b);-1!==c&&a.h.splice(c,1)}x.prototype.w=function(){for(;0<this.h.length;){var a=this.h.pop();B(this,a)}E(this)};function A(a,b){a.h.includes(b)||(a.l||a.w(),b.setAttribute("selected",""),b.setAttribute("aria-selected","true"),a.h.push(b))}(function(a){a.registerElement("amp-selector",x,"amp-selector [option]{cursor:pointer}amp-selector [option][selected]{cursor:auto;outline:1px solid rgba(0,0,0,0.7)}amp-selector [disabled][option],amp-selector[disabled] [option],amp-selector[disabled] [selected],amp-selector [selected][disabled]{cursor:auto;outline:none}\n/*# sourceURL=/extensions/amp-selector/0.1/amp-selector.css*/")})(self.AMP);
})});
//# sourceMappingURL=amp-selector-0.1.js.map

